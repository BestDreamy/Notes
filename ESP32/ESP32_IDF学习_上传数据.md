作业答辩结束了（让老师喷了一轮），但是突然发现学校的大创项目需要用到ESP32（甚至还可能用到乐鑫新出的ESP32-C3），看看自己写了那么一堆博文，决定一不做二不休，接着靠ESP-IDF一条路走到黑！

接着要看的就是ESP32的核心部分——联网传数据。

# 配网

联网传数据首先需要实现联网！

目前有以下几种适合ESP32的配网方法

## 写入固件

这个方法是最容易实现的。

按照之前WiFi部分的笔记，把相关代码写好，在ESP-IDF的menuconfig里配置完ssid和密码就能让设备联网了

但是很明显，生产产品的时候不能这么做

这种方式只适合调试和原型验证（还有交作业）

## SmartConfig

在实际应用中，往往会遇到很多不同的WiFi STA，通过将ssid和密码固定写入NVS或外设寄存器再连接的方式很明显不灵活

所以为了让嵌入式设备更简单地配网，SmartConfig应运而生

**SmartConfig**又名快连，能够实现在当前设备在没有和其他设备建立任何实际性通信链接的状态下，一键配置该设备接入WIFI，这个技术可以让手机通过配网APP向嵌入式设备发送当前连接的WiFi的ssid和密码，进而让嵌入式设备连接网络。

SmartConfig采用的是UDP广播模式（接收IP地址是255.255.255.255）。实现很简单：设备先scan环境下的所有AP，得到AP的相关信息，最基本的实现就是取得工作的channel；然后配置WiFi设备工作在刚才scan到的channel上去接收UDP包——如果没有接收到，继续配置工作在另外的channel 上，如此循环，直到收到UDP包为止。这样SmartConfig就完成了

这个配网方法的致命缺点就是成功率低，受当前场合的信号干扰影响大，而且有些路由器、手机或嵌入式设备不支持；优点则是可以一键配网，只要在手机上搭载相关的APP就能完成配置。











# lwIP协议栈

联网以后，自然需要一套嵌入式设备能使用的TCP/IP协议栈来让设备连接服务器或作为服务器提供服务

ESP32性能有限，使用一套称为LowPowerIP的小型IP协议栈，这就是**lwIP**













# HTTP









# WebSocket







# MDNS









# OPENSSL



















# MQTT

MQTT是典型的物联网数据传输协议

因为相关内容比较多所以单成篇

详细内容可查看MQTT相关教程和博文