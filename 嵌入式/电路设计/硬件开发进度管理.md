# 硬件开发进度管理

硬件项目，尤其是软硬件结合的智能硬件项目，与软件开发存在着非常大的差异。本篇博文就来结合自身理解谈一谈硬件项目开发进度管理相关的理论知识。

## 智能硬件的项目阶段

智能硬件是一个非常宽泛的概念，这里将我们要谈的范围局限在单板/多板组合硬件搭配实时控制软件和边缘端/云端计算软件的嵌入式产品。像是打卡机、扫地机器人、工业机械臂、智能音箱等都属于本篇探讨的范围。虽然这些设备都属于复杂系统，但是我们总能将其拆解为**硬件**（Hardware，HW）、**软件**（Software，SW）、**外观**（Identity，ID）、**结构**（Mechanic Design，MD）、**云平台**。其中硬件包含单板硬件、片上硬件（FPGA/CPLD）、多板互联；软件包含板级支持包（BSP）、底层引导程序（Bootloader）、操作系统与中间件（OS/Middleware）、应用程序（Application）、智能算法（AI）；云平台部分则包含云服务、后台、App、小程序等等，这里就先不展开了

虽然拆分以后，每个子系统都可以交付给专人负责，但还是非常复杂，这就需要在开发中引入合理的方法论，统筹管理进度，处理突发事件和需求变更。一般来说**智能硬件产品更加适用瀑布流开发**而不是互联网的敏捷开发，云平台部分通常交由专门的人员来完成，并作为一个大的子项目合并到总体开发流程中。

### IPD

**集成产品开发**（Integrated Product Development，**IPD**）理论原语《产品及生命周期优化法》一书，目前很多硬件科技公司都在采用该方法论来实现下面几个基本目的：

1. 缩短产品研发周期
2. 降低产品成本
3. 提高人均产出率
4. 降低研发费用占比
5. 提高产品质量

根据上面对设备部件的分类，可以将IPD进度管理以下面的表格划分

| 阶段         | 项目环节     | 实现步骤                         |
| ------------ | ------------ | -------------------------------- |
| 调研         | 项目导入     | 市场调查                         |
|              |              | 技术评估                         |
| 立项         | 立项会议     | 立项会议                         |
| PCBA单板设计 | 单板开发     | 方案设计                         |
|              |              | 项目配置确认、主板立项           |
|              |              | 原理图设计                       |
|              |              | 结构堆叠设计                     |
|              |              | 外围器件确认                     |
|              |              | 堆叠评审                         |
|              |              | 原理图优化                       |
|              |              | Layout                           |
|              |              | 第二轮Layout或打样               |
|              | PCBA试产     | PCBA试产物料准备                 |
|              |              | PCBA功能测试环境搭建             |
|              |              | PCBA试产软件开发                 |
|              |              | PCBA试产工程文件整理             |
|              |              | PCBA试产治具制作                 |
|              | PCBA验证测试 | SMT                              |
|              |              | 单板测试                         |
|              |              | 第二版测试                       |
| 外观结构开发 | ID           | ID设计                           |
|              |              | ID评估                           |
|              |              | 整机项目配置                     |
|              | MD           | MD设计                           |
|              |              | MD评审                           |
|              |              | MD投模                           |
|              |              | 结构辅料、连接器、副板、夹具制作 |
|              | 包装         | 包装、说明书设计                 |

### 外观和结构设计

一款新产品的基础就是ID设计，消费级产品总是要卖给一般消费者的，外观是消费者购买的一个重点因素；虽然企业级产品一般“注重内在”，但2B/2G的产品也要考虑外观不能做得太丑。

ID设计出2D渲染图后，就可以将其作为一个立项依据画大饼了，这时候硬件/软件/结构/云平台的开发/研发就要介入，做方案设计、软硬件评审等，完全通过后就可以进行详细设计。这一步是PCBA和软件设计的前提

HW需要对接ID、SW、MD，交接硬件的器件布局图、引脚图、关键器件尺寸等。SW需要对接HW、云平台，分别给出BSP的要求和API接口等。ID则根据MD的堆叠设计图进行3D建模，细化外观、内构；结构同步根据建模图制作详细结构设计，二者相互推进，并将进展共享给HW，如果涉及到冲突，可能还需要与SW协调。

详细结构设计完成转给模具厂、加工厂，ID和MD就可以转向其他工作了。HW往往需要更长的时间来完成PCBA设计。

### PCBA单板设计

对于硬件开发，要把主要精力放在硬件设计方案，核心物料选型，原理图，Layout四个关键步骤上，还要对后续的EMC、安规等检测步骤做预扫

板级硬件的嵌入式软件很少会严格按照软件工程的思维进行规划设计，主要是因为嵌入式软件是和单板业务强耦合的，一般只由一个人负责，最多会涉及不超过6人的小团队，好的嵌入式软件工程师必须有清晰的系统架构，并且会向上管理产品软件需求。只要能够保障*嵌入式软件可靠性*，软件部分就是合格的。

在HW接手ID的总体设计后需要结合需求功能设计单板，并与MD同步规划堆叠设计。由于硬件设计需要长周期物料备料和较长时间的打样周期，需要综合供应链和生产链设计单板。

### 从生产资料打包到单板测试

完成全部硬件设计后，SW就要开始介入了。

项目进度管理中，软件联调（尤其是首次软件联调）的时间点需要得到合理安排。必须注意如果固件要升级，还应该让单板硬件部分预留烧录点——一般来说软件不可能上板一次跑通，因此需要预留变更的升级方式（板烧、片烧、OTA都是可行的选项）

硬件生产资料（包括gerber文件、PCB工艺要求、BOM表、点位图、坐标文件、SMT要求）打包前，SW就应当开始BSP的开发，而上层的算法和云端软件应当在更早时刻开发。从生产资料打包发送到初版联调之间大约有不到一周时间，大多数情况下足以完成软件部分，正好可以在初版PCBA完工后烧录程序开始单板调试。

对于IPD来说，应当将硬件迭代作为例程（Routine）而不是异常（Exception），通过合理的时间点规划为硬件出错调试腾出时间，从而让项目在规定工期前完成。

### 嵌入式软件开发

嵌入式软件的开发主要分成：

* 片上硬件验证（包括FPGA和CPLD）
* 片上硬件开发
* 片上硬件算法
* 软件系统BSP（包括裸机BSP和RTOS-BSP）
* 软件驱动（包括RTOS驱动和嵌入式Linux驱动）
* Bootloader
* Linux内核移植和根文件系统调试

这里将FPGA和CPLD的硬件开发也归类为软件，但实际上片上硬件开发由于受到编程语言和开发难度限制，与传统软件开发区别很大，进度管理上也应当使用不同的方式。

片上硬件开发最大的特点就是难以调试，因此很多时候需要在服务器上仿真；与软件编译不同，大工程的硬件综合通常需要数十分钟到数小时乃至几天，这就需要大量的测试工作，因此对于小团队比较合适的方法是两个人负责片上硬件，一人负责业务代码，一人负责测试用例和脚本开发。即使如此，一个成熟的IP设计也需要数周乃至数月时间才可以完成。

不过对于大多数应用，片上硬件的主要业务就是连接各个高速接口和控制高速的AD/DA，更复杂的业务就是采用APSOC单片完成FPGA+嵌入式Linux的功能（进行ISP、DSP等），因此可以调用厂商提供的接口IP。由于FPGA往往引脚资源很丰富，所以很多时候不必参考硬件原理图可提前开始进行功能性验证，同步与HW出IO Bank、Serdes Pin的安排，再到物理约束修改即可

软件部分就是传统的嵌入式开发流程，根据硬件给出的原理图和引脚安排来编写BSP、Linux驱动等。将嵌入式Linux移植上板以后，基本任务就完成了。后续流程要和云平台协作出端App和云App，算法部分通过CPU、GPU、NPU、硬件加速等手段部署到片上

所有嵌入式软件应当打包成固件（firmware），统一烧录到板。

等待SMT和硬件基础调试完成后，软件即可开始联调，项目管理中应当为软硬件联调预留一周以上时间，确保出现问题的情况下能够及时补救，不至于耽误期限

### 云端软件开发

云端软件本质上就是互联网行业常见的业务了，不管是外包还是由专门的产品经理PM负责，都可以套用软件工程来解决，可以视为与智能硬件解耦，因此算是不需要多加操心的

> 找一个靠谱队友的重要性

## 开发流程简介

我们将一款产品开发-试产-上市-更新-淘汰的进度分成100份，即从0到100，于是可以分成两个板块：从0到1和从1到100。从0到1的过程需要合理的商业计划和产品研发人员的努力攻关，而从1到100的过程则需要销售、运营、维护人员的持续投入。这里我们主要谈的还是从0到1这个过程

### 市场需求调研



### 产品研发实现



### 商业论证分析



### 量产化













